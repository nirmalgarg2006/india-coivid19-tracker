<!DOCTYPE html>
<html>
<head>
	<title>India Covid Cases</title>
	<meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.16.0/umd/popper.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
    <link rel="preconnect" href="https://fonts.gstatic.com">
    <link href="https://fonts.googleapis.com/css2?family=Josefin+Sans" rel="stylesheet">
    <style>
        *{
    		margin: 0;
    		padding: 0;
    		font-family: 'Josefin Sans', sans-serif;
    	}
	</style>
	
</head>
<body>
<section>
        <div class="container">
        	<h1 class="text-center text-capitalize pt-2">Covid19 India Tracker</h1>
            <hr class="w-50 mx-auto">
            <div class="row">
    			<div class="col-lg-8 col-md-8 col-12 mr-auto">
    				<a href="./statewisecovidcases.html" target="_black" class="btn btn-primary">Statewise</a>
    				<button class="btn btn-primary" onclick="refreshData(); return false;">Refresh</button>
    			</div>
    			<div class="col-lg-4 col-md-4 col-12 ml-auto">
    				<p>Last Updated Time : <span  id="lastUpdatedTime"></span><p>
    			</div>
    		</div>
            <div class="row mb-5 pt-2">
                <div class="col-lg-4 col-md-4 col-12 ">
                    <div class="card bg-info text-white text-center font-weight-bold">
                        <div class="card-body" style="font-size: 30px;">
                            <p>Today's Cases</p>
                            <p>Count : <span id="todaycases"></span></p>
                        </div>
                    </div>
                </div>
                <div class="col-lg-4 col-md-4 col-12">
                    <div class="card bg-success text-white text-center font-weight-bold">
                        <div class="card-body" style="font-size: 30px;">
                            <p>Today's Recovered</p>
                            <p>Count : <span id="todayrecovered"></span></p>
                        </div>
                    </div>
                </div>
                <div class="col-lg-4 col-md-4 col-12">
                    <div class="card bg-danger text-white text-center font-weight-bold">
                        <div class="card-body" style="font-size: 30px;">
                            <p>Today's Deaths</p>
                            <p>Count : <span id="todaydeaths"></span></p>
                        </div>
                    </div>
                </div>
            </div>
            <div class="row mb-5">
                <div class="col-lg-4 col-md-4 col-12 ">
                    <div class="card bg-info text-white text-center font-weight-bold">
                        <div class="card-body" style="font-size: 30px;">
                            <p>Total Cases</p>
                            <p>Count : <span id="totalcovidcases"></span></p>
                        </div>
                    </div>
                </div>
                <div class="col-lg-4 col-md-4 col-12">
                    <div class="card bg-success text-white text-center font-weight-bold">
                        <div class="card-body" style="font-size: 30px;">
                            <p>Total Recovered</p>
                            <p>Count : <span id="totalrecovered"></span></p>
                        </div>
                    </div>
                </div>
                <div class="col-lg-4 col-md-4 col-12">
                    <div class="card bg-danger text-white text-center font-weight-bold">
                        <div class="card-body" style="font-size: 30px;">
                            <p class="text-capitalize">Total Deaths</p>
                            <p>Count : <span id="totaldeaths"></span></p>
                        </div>
                    </div>
                </div>
            </div>
            <div class="row mb-5">
        		
                <div class="col-lg-4 col-md-4 col-12 ml-auto mr-auto">
                    <div class="card bg-warning text-white text-center font-weight-bold">
                        <div class="card-body" style="font-size: 30px;">
                            <p>Total Active Cases</p>
                            <p>Count : <span id="totalactivecase"></span></p>
                        </div>
                    </div>
                </div>
                
            </div>
        </div>
    </section>
</body>
    <script type="text/javascript">
        var httpRequest;
let statewisedata;
    function handleClick(event) {
        alert(event.nodeName);
    }

    function getCovidData() {
        makeRequest();
    }

    function makeRequest() {
        let url = 'https://api.covid19india.org/data.json';
        httpRequest = new XMLHttpRequest();

        if (!httpRequest) {
            alert('Giving up :( Cannot create an XMLHTTP instance');
            return false;
        }
        httpRequest.onreadystatechange = alertContents;
        httpRequest.open('GET', url);
        httpRequest.send();
    }

    function alertContents() {
        if (httpRequest.readyState === XMLHttpRequest.DONE) {
            if (httpRequest.status === 200) {
                let coviddata = JSON.parse(httpRequest.responseText);
                statewisedata = coviddata.statewise;
                for (let i = 0; i < statewisedata.length; i++) {
                    if (statewisedata[i].statecode === 'TT') {
                        let totalcovidcases = statewisedata[i].confirmed;
                        let totalactivecase = statewisedata[i].active;
                        let totaldeaths = statewisedata[i].deaths;
                        let totalrecovered = statewisedata[i].recovered;
                        let todaycases = statewisedata[i].deltaconfirmed;
                        let todayrecovered = statewisedata[i].deltarecovered;
                        let todaydeaths = statewisedata[i].deltadeaths;
                        document.getElementById('totalcovidcases').innerText = totalcovidcases;
                        document.getElementById('totalactivecase').innerText = totalactivecase;
                        document.getElementById('totaldeaths').innerText = totaldeaths;
                        document.getElementById('totalrecovered').innerText = totalrecovered;
                        document.getElementById('todayrecovered').innerText = todayrecovered;
                        document.getElementById('todaycases').innerText = todaycases;
                        document.getElementById('todaydeaths').innerText = todaydeaths;
						document.getElementById('lastUpdatedTime').innerText = statewisedata[i].lastupdatedtime;
                    }
                }

            } else {
                alert('There was a problem with the request.');
            }
        }
    }

    $(window).on('load', () => {
        makeRequest();
    })

    function refreshData(){
        makeRequest();
    }

   
    </script>
</html>